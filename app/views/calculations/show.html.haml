- unless current_user
    - if notice
        - append :head do
            %script{ type: 'text/javascript' }
                window.onload = function() { componentsModalOpen('.modal.signup'); };

= link_to (current_user ? calculations_url : url_for(:back)), class: 'back' do
    = asset 'components/back.svg'

.tools
    .copy{ data: { clipboard_text: @calculation.result.value.to_s } }= asset 'icons/ungroup.svg' unless @calculation.result.undefined
    .share.md-trigger{ data: { modal: '.share' } }= asset 'icons/share-26.svg'
    .delete.md-trigger{ data: { modal: '.delete' } }= asset 'icons/trash-round.svg'



.head-wrapper
    - if @calculation.result.undefined
        %h2= t 'd.undefined'
    - else
        %h2.copy{ data: { clipboard_text: @calculation.result.value.to_s } }
            = @calculation.result.pretty_value
            %span= @calculation.unit_of_measurement.symbol
    %p
        %span= link_to @calculation.quantity.name, @calculation.quantity
        ·
        %span= timeago @calculation.created_at

- unless current_user
    - if notice
        .account-wrapper{ class: ('invisible' if notice) }
            .flex-wrapper
                = link_to t('d.signup'), new_user_registration_url(calculation: @calculation.id), class: 'btn'
                = link_to t('d.signin'), new_user_session_url(calculation: @calculation.id), class: 'btn secondary'

.content-wrapper
    - if can? :update, @calculation
        .md-trigger{ data: { modal: '.edit' } }
            %h3= @calculation.name || t('calculations.show.details.add')
            %p= @calculation.description if @calculation.description

    %h3= t 'd.p.units_of_measurement'
    .cards
        - @calculation.measurements.each do |measurement|
            = link_to request.base_url + '/calculations/' + @calculation.id.to_s + '/measurements/' + measurement.id.to_s, class: 'card' do
                .wrapper
                    %h2.small
                        = measurement.pretty_value
                        %span= measurement.unit_of_measurement.symbol
                    %p.small
                        %span= measurement.name || measurement.quantity.name
                        - if measurement.name
                            ·
                            %span= measurement.quantity.name
                = asset 'components/list/item-open.svg'






.modal.share
    .modal-content-wrapper
        %h3= t 'd.share'
        .wrapper
            = link_to 'Facebook', "https://www.facebook.com/sharer/sharer.php?u=#{request.original_url}", target: '_blank'
            = link_to 'Twitter', "https://twitter.com/home?status=I%20created%20a%20new%20calculation%20with%20%40phylator.%20Take%20a%20look!%20#{request.original_url}", target: '_blank'
            = link_to 'Google +', "https://plus.google.com/share?url=#{request.original_url}", target: '_blank'
            = link_to t('d.email'), "mailto:?&subject=My%20new%20calculation&body=Take%20a%20look!%20#{request.original_url}"

.modal.signup
    .modal-content-wrapper
        %h3= t 'calculations.show.save.title'
        %p= t 'calculations.show.save.content'
        .flex-wrapper
            = link_to t('d.signup'), new_user_registration_url(calculation: @calculation.id), class: 'btn'
            = link_to t('d.signin'), new_user_session_url(calculation: @calculation.id), class: 'btn secondary'

.modal.edit
    .modal-content-wrapper
        = simple_form_for(@calculation) do |f|
            = f.input :name, label: t('d.title')
            = f.input :description, label: t('d.description')
            .flex-wrapper
                = f.button :submit, t('d.save')

.modal.delete
    .modal-content-wrapper
        = link_to t('d.delete') + '?', calculation_url(@calculation), method: :delete, class: 'btn warn'


-# %span
-#     = '+-'
-#     - if @calculation.result.margin_of_error.to_s.size > 12
-#         = "%e" % @calculation.result.margin_of_error.to_s
-#     - else
-#         = @calculation.result.margin_of_error.to_s
